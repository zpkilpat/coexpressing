# coexpressing
This repository provides a conceptual neural population model illustrating how DA-only and DA+Glu VTA populations can differentially bias action selection in appetitive vs aversive contexts, including simple knockout (KO) simulations.

**Reproducibility & environment**
Language: MATLAB (R2016b+; tested on R2018b+)  
Determinism: rng(42) set in the script  
Outputs: written to ./data/ with a timestamp  

**Quick start**
% From the repo root:  
open vta_daglu_conceptual_model.m  
run vta_daglu_conceptual_model

This generates three figures and a parameter bundle in ./data/:  
figure1_*: Reward CS+ hits (per-day mean ± SEM), Control vs VGluT2 KO  
figure2_*: Reward latency, Control vs VGluT2 KO  
figure3_*: Shock freezing fraction, Control vs DA/TH KO  
params_*.mat and params_*.json: full parameter structs (reward, shock, KOs, drives)  

**What the script does:** Two abstract VTA populations (DA-only, DA+Glu) receive a conditioned stimulus (CS) and a possible outcome (reward/shock/none). Population signals are synaptically filtered and combined to drive a single action-accumulation variable with a thresholded readout (hits in reward; freezing fraction in shock). Slow, event-driven gains with decay produce acquisition-like changes across simulated days (illustrative—not a specific learning rule). KOs scale transmitter weights to show qualitative contrasts aligned with recordings/behavior.  

**Statistical analysis reported**
Curve comparisons (across days): permutation test on Euclidean (L2) distance between per-day group means; permutation unit = blocks (not trials)
Terminal performance: mean of the last 5 days

**Data availability.** All data needed to evaluate the conclusions of the paper are present in the main text and/or the Supplementary Materials. Processed simulation outputs (figures and parameter bundles) are generated by running vta_daglu_conceptual_model.m and are written to the ./data/ directory.

**Code availability.** The MATLAB code used to generate the results in this study is available in this repository. The script can be executed as-is in MATLAB R2016b or later; no external toolboxes are required.

**If you use or adapt this code, please cite:**
Emily D. Prévost, Lucy Ward, Daniel Alas, Giulia Aimale, Sara Ikenberry, Katie Fox, Julianne Pelletier, Annie Ly, Jayson Ball, Zachary P Kilpatrick, Kailyn Price, Abigail M. Polter, David H. Root. "Untangling dopamine and glutamate in the ventral tegmental area." (2025)

License
- **Code**: MIT © 2025, Zachary P Kilpatrick. See [`LICENSE`](LICENSE).
- **Text & figures**: CC BY 4.0. See [`LICENSE-DOCS`](LICENSE-DOCS).

